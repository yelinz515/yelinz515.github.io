---
emoji: ğŸ¦·
title: '[React] ëŒ“ê¸€ì°½ ë§Œë“¤ê¸°'
date: '2022-11-20'
author: ê¹€ì˜ˆë¦°
tags: codestates
categories: mainproject
---

![detail.gif](detail.gif)

ìƒì„¸í˜ì´ì§€ì— Toast-UI ì—ë””í„°ë¥¼ ì‚¬ìš©í•´ì„œ ëŒ“ê¸€ ê¸°ëŠ¥ì„ ì ìš©í–ˆë‹¤.

[Toast UI Editor](https://ui.toast.com/tui-editor)

<br>

## Editor ì„¤ì¹˜

ë¦¬ì•¡íŠ¸ì—ì„œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— toast ui editorì˜ React Wrapper ë²„ì „ì„ ì„¤ì¹˜

```
npm install @toast-ui/react-editor
```

<br>

## 1. ëŒ“ê¸€ ì‘ì„±í•˜ê¸°

---

```js
// Comment.js
import { Button, Paper } from '@mui/material';

import '@toast-ui/editor/dist/toastui-editor.css';
import { Editor } from '@toast-ui/react-editor';

import SkeletonComment from '../../components/Skeleton/SkeletonComment';

const onSubmit = async (e) => {
  e.preventDefault();

  // ê°’ ê°€ì ¸ì˜¤ê¸°
  const editorInstance = editorRef.current.getInstance();
  // ë§ˆí¬ë‹¤ìš´ í…ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œí•´ì£¼ëŠ” ë‚´ì¥ ë©”ì„œë“œ getMarkdown() ì´ìš©
  const getContent = editorInstance.getMarkdown();
  setDisplay(!display);

  setComment([
    ...comment,
    {
      replyContent: getContent,
      replyId: id,
      memberId: memberId,
      nickname: user,
      createdAt: `${date}`,
      modifiedAt: `${date}`,
      responseTo: 'root',
      exist: true,
    },
  ]);

  const addComment = {
    replyContent: getContent,
    replyId: id,
    memberId: memberId,
    nickname: user,
    createdAt: `${date}`,
    modifiedAt: `${date}`,
    responseTo: 'root',
    exist: true,
  };
  await axios.post(`${process.env.REACT_APP_API_URL}reply/` + id, addComment);

  await axios.get(`${process.env.REACT_APP_API_URL}reply/` + id).then((result) => {
    setComment(result.data.data);
  });
};

const onclickHandler = () => {
  if (memberId) {
    setDisplay(!display);
  } else if (!memberId) {
    alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
    navigate('/login');
  }
};

return (
  <>
    {loading && <SkeletonComment />}
    {!loading && (
      <Paper sx={{ mt: 1, mb: 10, width: 690 }}>
        <Button
          onClick={() => onclickHandler()}
          sx={{
            width: '5.5rem',
            fontSize: 12,
          }}
        >
          ëŒ“ê¸€ ì‘ì„±
        </Button>
        {display && (
          <>
            {/* toast editor */}
            <Editor ref={editorRef} />
            <div>
              <Button sx={{ color: '#afafaf' }} onClick={onSubmit}>
                ì €ì¥
              </Button>
            </div>
          </>
        )}
      </Paper>
    )}
  </>
);
```

###

ë¡œê·¸ì¸ í–ˆì„ ë•Œ ëŒ“ê¸€ ì‘ì„± ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ toast editorê°€ ë‚˜íƒ€ë‚˜ì§€ë§Œ,

![detail.gif](notlogin2.gif)

íšŒì› ì •ë³´ê°€ ì—†ë‹¤ë©´, ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™ì‹œí‚¨ë‹¤.

<br>

## 2. ëŒ“ê¸€ ìˆ˜ì • & ì‚­ì œ

---

```js
import '@toast-ui/editor/dist/toastui-editor.css';
import { Editor } from '@toast-ui/react-editor';

// ëŒ“ê¸€ ìˆ˜ì •
const onEdit = async ({ replyId }) => {
  const editorInstance = editorRef.current.getInstance();
  const getContent = editorInstance.getMarkdown();

  setComment([
    {
      replyContent: getContent,
      replyId: id,
      memberId: memberId,
      nickname: user,
      createdAt: `${date}`,
      modifiedAt: `${date}`,
      responseTo: 'root',
      exist: false,
    },
  ]);

  const editComment = {
    replyContent: getContent,
    replyId: id,
    memberId: memberId,
    nickname: user,
    createdAt: `${date}`,
    modifiedAt: `${date}`,
    responseTo: 'root',
    exist: false,
  };
  // uiëŠ” ì˜ ë¨,
  await axios.patch(`${process.env.REACT_APP_API_URL}reply/` + replyId, editComment).then(() => {
    setComment(comment);
  });

  await axios.get(`${process.env.REACT_APP_API_URL}reply/` + id).then((result) => {
    setComment(result.data.data);
  });
};

// ëŒ“ê¸€ ì‚­ì œ
const onRemove = async ({ replyId }) => {
  await axios.delete(`${process.env.REACT_APP_API_URL}reply/` + replyId);

  await axios.get(`${process.env.REACT_APP_API_URL}reply/` + id).then((result) => {
    setComment(result.data.data);
  });
};

return (
  <>
    {/* comment ìˆ˜ì • */}
    {comment.memberId === memberId && (
      <>
        {openEditor === comment.replyId && <Editor value={comment.replyContent} ref={editorRef} />}
        <Button
          sx={{ color: '#afafaf', fontSize: 12 }}
          onClick={() => {
            if (comment.replyId === openEditor) {
              onEdit(comment);
              setOpenEditor('');
            } else {
              setOpenEditor(comment.replyId);
            }
          }}
        >
          ìˆ˜ì •
        </Button>

        {/* comment ì‚­ì œ */}
        <Button
          sx={{ color: '#afafaf', fontSize: 12 }}
          onClick={() => {
            onRemove(comment);
          }}
        >
          ì‚­ì œ
        </Button>
      </>
    )}
  </>
);
```

<br>
<br>

## ê²°ê³¼ í™”ë©´ - ìˆ˜ì •

---

![comment_edit.gif](comment_edit.gif)

###

(ìœ„ì— ë³´ì´ëŠ” í™”ë©´ê³¼ ë‹¤ë¥´ê²Œ ëŒ“ê¸€ ì‘ì„±ì ì´ë¦„ê³¼ ì‘ì„± ì‹œê°„ì´ ë‚˜ì™€ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, ì‘ì„± ëŒ“ê¸€ ì‘ì„±ìë§Œ í•´ë‹¹ ê¸€ì„ ìˆ˜ì •í•  ìˆ˜ ìˆê²Œ êµ¬í˜„í•´ ë†“ì•˜ìŠµë‹ˆë‹¤. í˜„ì¬ ì„œë²„ê°€ ë‹«í˜€ìˆì–´ ì—´ë¦¬ë©´ ì‚¬ì§„ì„ ë°”ê¿”ë†“ê² ìŠµë‹ˆë‹¤âœï¸âœï¸âœï¸)

ì¶”í›„ ëŒ€ëŒ“ê¸€ ê¸°ëŠ¥ ë„£ì–´ë³´ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.
